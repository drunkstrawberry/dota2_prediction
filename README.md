# Предсказание исхода матча Dota 2 по данным игроков и героев
Этот проект посвящён построению модели машинного обучения, которая предсказывает исход матча Dota 2 на основе состава команд, выбранных героев и исторических данных игроков. Анализ включает предобработку данных, исследовательский анализ (EDA), построение нескольких моделей и оценку их качества.

# Цель проекта
Ответить на исследовательский вопрос:
Можно ли предсказать исход матча Dota 2 (победу или поражение) по данным о героях, игроках и исторических метриках без информации о событиях внутри матча (т.е. фактически **до начала игры**)

# Используемые данные
Данные взяты из соревнований на Kaggle и доступны по ссылке:
https://www.kaggle.com/competitions/dota-2-hse-ml-1-course-competition-2025/data
Данные содержат информацию о матчах: id игроков, героев, бинарную переменную "исход матча", которая становится целевым признаком
Также таблицы содержат информацию о героях и их способностях. Охватываемый данными период: 1 год, всего данные содержат информацию о 974 931 уникальных игроков и 767 822 уникальных матчей.

# Этапы исследования
**1. Предобработка данных**
- удаление нерелевантных колонок
- объединение таблиц
- обработка пропусков
- устранение выбросов
- проверка корректности матчей и игроков

**2. Исследовательский анализ данных (EDA)**
- распределение побед между Radiant и Dire
- частоты выбора героев
- герои с наименьшей и наибольшей долей побед
- распределение длительностей матчей

**3. Создание новых признаков**
Для предсказательной модели были созданы 4 новых признака

- **Сильная пара**
Некоторые герои чаще выигрывают в паре, так как образуют сильные связки. Были вычислены винрейты за все время для каждой пары героев в одной команде и, если винрейт превышал 60% паре героев присваивался признак "Сильная пара" (1, 0)

- **Контр-пик**
Некоторые герои часто проигрывают против определенных, это называется контр-пик. Для каждой пары героев в противоположных командах был вычислен винрейт. Если винрейт героя А против героя Б больше 60%, то в колонке "Контр-пик" герой А получает значение 1, а герой Б - -1, в противном случае - 0.

- **Мета**
В доте часто выходят обновление (патчи), усиляющие одних героев и ослабляющие других незначительно. Благодаря этому формируется "мета" - набор героев, особенно сильных в текущем обновлении. Например, киберспортсмены на турнирах обычно выбирают более "метовых" героев, чтобы повысить свои шансы на победу, высокоранговые игроки также часто опираются на мету.
Признак "Метовый винрейт" показывает винрейт героя за месяц, рассчитанный скользящим средним.

- **Мастер своего героя**
Очевидно, что чем больше игрок играет на конкретном герое и побеждает, тем больше он погружен в механики героя и тем легче ему выиграть новую игру на нем. Таким образом, признак "Мастер своего героя" принимал значение 1, если общий винрейт игрока на герое превышал 60% и 0, если нет. Этот признак был рассчитан только для игроков, у которых больше 20 игр на герое.

**5. Моделирование**
Далее для каждого матча считалась сумма признаков "Сильная пара", "Контр-пик" и "Мастер своего героя" по командам, среднее по признаку "Мета" и вычислялась разница этих признаков по командам: Radiant - Dire
Таким образом получалось 4 признака для каждого матча, по которым предсказывался исход игры

Были использованы следующие модели

**Бейзлайны**
- Logistic Regression (Acc = 0,6349)
- Ridge Classifier (Acc = 0,6348)
- Naive Bayes (Acc = 0,6280)
- KNN (k=15) (Acc = 0,6111)

**Ансамблевые модели**
- HistGBM (Acc = 0,6356)
- LightGBM (Acc = 0,6350)
- Desision Tree (Acc = 0,6111)

**Нейронные сети**
- Neural Oblivion Gradient Boosted (Acc = 0,6358)
- Tiny Neural Network (0,6353)

**Выводы**

От использования многих моделей пришлось отказаться в силу очень большого объема данных (700 тыс наблюдений) и нехватки вычислительных мощностей
В будущем этот проект можно было бы доработать, внедрив больше признаков и сделав их всех количественными, а не бинарными. Также стоило бы учитывать характеристики героев (их роль, атрибуты, позицию). Возможно, с такими изменениями можно будет добиться более точных предсказний.

